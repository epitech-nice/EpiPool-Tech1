(function(){"use strict";var t={6081:function(t,e,s){var n=s(5130),a=s(6768);const o={id:"app",class:"flex_w_gap"};function i(t,e,s,n,i,r){const l=(0,a.g2)("SliderList"),d=(0,a.g2)("TeamDashBoard");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(l,{onTeamSelected:r.setSelectedTeam},null,8,["onTeamSelected"]),(0,a.bF)(d,{team:i.selectedTeam},null,8,["team"])])}var r=s(4232);const l={class:"slide-holder",ref:"slider"},d=["onClick"];function c(t,e,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",l,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.teams,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:"slide",onClick:e=>i.selectTeam(t),style:(0,r.Tr)({backgroundImage:`url(/assets/${t.filename})`})},null,12,d)))),128))],512)}var u=s(4373),m=s(6587),h=s.n(m),p=(s(7516),{name:"SliderList",data(){return{teams:[]}},async mounted(){await this.fetchTeams(),await(0,a.dY)(),this.initializeSlider()},methods:{async fetchTeams(){try{const t=await u.A.get("http://localhost:3000/api/teams/starter_teams");this.teams=t.data}catch(t){console.error("There was an error fetching the teams!",t)}},initializeSlider(){h()(this.$refs.slider).slick({dots:!0,infinite:!0,slidesToShow:1,slidesToScroll:1,arrows:!1}).on("afterChange",((t,e,s)=>{this.selectTeam(this.teams[s])}))},selectTeam(t){this.$emit("teamSelected",t)}}}),f=s(1241);const v=(0,f.A)(p,[["render",c]]);var g=v;const y={class:"dashboard-container"},k={class:"header"},b={key:0,class:"team-points team-name"},_={key:1},C=(0,a.Lk)("p",null,"Please select a team from the slider.",-1),S=[C],L={class:"header mt10"};function w(t,e,s,n,o,i){const l=(0,a.g2)("TeamPoints"),d=(0,a.g2)("LogsHistory"),c=(0,a.g2)("AdjustPoints"),u=(0,a.g2)("StudentScoreboard"),m=(0,a.g2)("CSV");return(0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("div",k,[(0,a.bF)(l,{ref:"teamPoints",team:s.team},null,8,["team"]),s.team?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("h3",null,(0,r.v_)(s.team.name)+" ( "+(0,r.v_)(s.team.color)+" )",1)])):((0,a.uX)(),(0,a.CE)("div",_,S))]),(0,a.Lk)("div",L,[s.team?((0,a.uX)(),(0,a.Wv)(d,{key:0,team:s.team,style:{width:"calc(100% / 3)"}},null,8,["team"])):(0,a.Q3)("",!0),s.team?((0,a.uX)(),(0,a.Wv)(c,{key:1,team:s.team,onPointsUpdated:i.refreshPoints},null,8,["team","onPointsUpdated"])):(0,a.Q3)("",!0),s.team?((0,a.uX)(),(0,a.Wv)(u,{key:2,team:s.team,style:{width:"calc(100% / 3)"}},null,8,["team"])):(0,a.Q3)("",!0)]),(0,a.bF)(m)])}const T={class:"team-points w30"},E={key:0},F={key:1};function P(t,e,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",T,[null!==o.points?((0,a.uX)(),(0,a.CE)("h3",E,(0,r.v_)(o.points[0].points)+" points",1)):((0,a.uX)(),(0,a.CE)("h3",F,"Loading..."))])}var X={name:"TeamPoints",props:{team:{type:Object,required:!0}},data(){return{points:null}},watch:{team:{immediate:!0,handler(t){t&&this.fetchPoints(t.team_id)}}},methods:{async fetchPoints(t){try{const e=await u.A.get("http://localhost:3000/api/points/points_by_team",{params:{team_id:t}});this.points=e.data.points}catch(e){console.error("Error fetching points:",e)}}}};const A=(0,f.A)(X,[["render",P]]);var O=A;const j={class:"adjust-points"},D=(0,a.Lk)("span",{class:"title-underscore"},"Adjust Points",-1),I={key:0,class:"blurbackground"},x={key:1,class:"popup"},Q=(0,a.Lk)("label",{for:"action"},"Action",-1),V=(0,a.Lk)("option",{value:"add"},"Add Points",-1),$=(0,a.Lk)("option",{value:"remove"},"Remove Points",-1),U=[V,$],q=(0,a.Lk)("label",{for:"target"},"Target",-1),K={value:"team"},M=(0,a.Lk)("option",{value:"student"},"Student",-1),W={key:0,for:"selectedStudent"},R=(0,a.Lk)("option",{value:""},"Select a student",-1),z=["value"],H=(0,a.Lk)("label",{for:"points"},"Quantity",-1),B=(0,a.Lk)("label",{for:"reason"},"Reason",-1),J={class:"flex-line"},N=(0,a.Lk)("button",{type:"submit"},"Submit",-1);function Y(t,e,s,o,i,l){return(0,a.uX)(),(0,a.CE)("div",j,[D,(0,a.Lk)("button",{onClick:e[0]||(e[0]=t=>i.showForm=!0),style:{"font-weight":"bold",margin:"15px"}},"Add / Remove Points"),i.showForm?((0,a.uX)(),(0,a.CE)("div",I)):(0,a.Q3)("",!0),i.showForm?((0,a.uX)(),(0,a.CE)("div",x,[(0,a.Lk)("button",{class:"close-button",onClick:e[1]||(e[1]=t=>i.showForm=!1)},"✕"),(0,a.Lk)("form",{onSubmit:e[8]||(e[8]=(0,n.D$)(((...t)=>l.submitPoints&&l.submitPoints(...t)),["prevent"])),class:"form-flex"},[Q,(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>i.action=t)},U,512),[[n.u1,i.action]]),q,(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>i.target=t)},[(0,a.Lk)("option",K,"Team ("+(0,r.v_)(this.team.color)+")",1),M],512),[[n.u1,i.target]]),"student"===i.target?((0,a.uX)(),(0,a.CE)("label",W,"Student")):(0,a.Q3)("",!0),"student"===i.target?(0,a.bo)(((0,a.uX)(),(0,a.CE)("select",{key:1,"onUpdate:modelValue":e[4]||(e[4]=t=>i.selectedStudent=t),required:""},[R,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.students,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.email,value:t},(0,r.v_)(t.name)+" - "+(0,r.v_)(t.points)+" points ",9,z)))),128))],512)),[[n.u1,i.selectedStudent]]):(0,a.Q3)("",!0),H,(0,a.bo)((0,a.Lk)("input",{type:"number",class:"smallCube","onUpdate:modelValue":e[5]||(e[5]=t=>i.points=t),required:""},null,512),[[n.Jo,i.points]]),B,(0,a.bo)((0,a.Lk)("input",{type:"text",id:"reason","onUpdate:modelValue":e[6]||(e[6]=t=>i.reason=t),required:"",placeholder:"Enter a reason or leave as 'Pedago'"},null,512),[[n.Jo,i.reason]]),(0,a.Lk)("div",J,[(0,a.Lk)("button",{onClick:e[7]||(e[7]=t=>i.showForm=!1)},"Cancel"),N])],32)])):(0,a.Q3)("",!0)])}var G={name:"AdjustPoints",props:{team:{type:Object,required:!0}},data(){return{points:0,action:"add",target:"team",students:[],selectedStudent:null,showForm:!1,reason:"Pedago"}},watch:{"team.team_id":{immediate:!0,handler(){this.fetchStudents()}}},methods:{async fetchStudents(){if(this.team&&this.team.team_id)try{const t=await u.A.get("http://localhost:3000/api/students/students_by_team",{params:{team_id:this.team.team_id}});this.students=t.data,this.students.length>0&&(this.selectedStudent=this.students[0])}catch(t){console.error("Error fetching students:",t)}},async submitPoints(){let t,e;if("team"===this.target)t="add"===this.action?"http://localhost:3000/api/points/add_points_to_team":"http://localhost:3000/api/points/remove_points_to_team",e={team_id:this.team.team_id,points:this.points,reason:this.reason};else{if("student"!==this.target||!this.selectedStudent)return void alert("Please select a student.");t="add"===this.action?"http://localhost:3000/api/students/add_points_to_student":"http://localhost:3000/api/students/remove_points_from_student",e={student_id:this.selectedStudent.student_id,points:this.points,reason:this.reason}}try{await u.A.put(t,e),this.points=0,this.showForm=!1,this.$emit("points-updated")}catch(s){console.error("Error modifying points:",s)}}}};const Z=(0,f.A)(G,[["render",Y]]);var tt=Z;const et={class:"team-points flex-column"},st=(0,a.Lk)("span",{class:"title-underscore"},"Last Events",-1),nt={class:"log"};function at(t,e,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",et,[st,(0,a.Lk)("div",nt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.logs,(t=>((0,a.uX)(),(0,a.CE)("p",{key:t.log_id},(0,r.v_)(t.name)+" "+(0,r.v_)(t.points>0?"a gagné "+t.points+" points grâce à ":"a perdu "+Math.abs(t.points)+" points à cause de ")+(0,r.v_)(t.reason),1)))),128))])])}var ot={name:"LogsHistory",props:{team:{type:Object,required:!0}},data(){return{logs:[]}},watch:{"team.team_id":{immediate:!0,handler(){this.fetchLogs()}}},methods:{async fetchLogs(){if(this.team&&this.team.team_id)try{const t=await u.A.get("http://localhost:3000/api/logs/logs_by_team",{params:{team_id:this.team.team_id}});this.logs=t.data}catch(t){console.error("Error fetching logs:",t)}}}};const it=(0,f.A)(ot,[["render",at]]);var rt=it;const lt={class:"team-points flex-column",style:{width:"calc(33.3333%)"}},dt=(0,a.Lk)("span",{class:"title-underscore"},"Students",-1),ct={class:"log"},ut={class:"icons-end"},mt=["onClick"],ht=["onClick"],pt={key:0,class:"blurbackground"},ft={key:1,class:"popup"},vt=(0,a.Lk)("label",{for:"teams"},"Teams",-1),gt=["value"],yt=(0,a.Lk)("button",{type:"submit"},"Change Team",-1);function kt(t,e,s,o,i,l){const d=(0,a.g2)("svg-icon");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",lt,[dt,(0,a.Lk)("div",ct,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.students,(t=>((0,a.uX)(),(0,a.CE)("div",{class:"student-orders",key:t.log_id},[(0,a.eW)((0,r.v_)(t.name)+" - "+(0,r.v_)(t.email)+" ("+(0,r.v_)(t.points)+" points) ",1),(0,a.Lk)("div",ut,[(0,a.Lk)("button",{onClick:e=>l.openChangeTeamForm(t),class:"icon-button change"},[(0,a.bF)(d,{type:"mdi",path:i.changeTeam},null,8,["path"])],8,mt),(0,a.Lk)("button",{onClick:e=>l.removeStudent(t.student_id),class:"icon-button cancel"},[(0,a.bF)(d,{type:"mdi",path:i.cancel},null,8,["path"])],8,ht)])])))),128))])]),i.showForm?((0,a.uX)(),(0,a.CE)("div",pt)):(0,a.Q3)("",!0),i.showForm?((0,a.uX)(),(0,a.CE)("div",ft,[(0,a.Lk)("button",{class:"close-button",onClick:e[0]||(e[0]=t=>i.showForm=!1)},"✕"),(0,a.Lk)("form",{onSubmit:e[2]||(e[2]=(0,n.D$)(((...t)=>l.submitChange&&l.submitChange(...t)),["prevent"])),class:"form-flex"},[vt,(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>i.selectedTeamId=t),required:""},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.teams,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.team_id,value:t.team_id},(0,r.v_)(t.name)+" - "+(0,r.v_)(t.color),9,gt)))),128))],512),[[n.u1,i.selectedTeamId]]),yt],32)])):(0,a.Q3)("",!0)],64)}var bt=s(1517),_t=s(2132),Ct={name:"StudentScoreboard",components:{SvgIcon:bt.A},props:{team:{type:Object,required:!0}},data(){return{students:[],teams:[],cancel:_t.lu1,changeTeam:_t._AM,showForm:!1,selectedStudent:null,selectedTeamId:null}},watch:{"team.team_id":{immediate:!0,handler(){this.fetchStudents(),this.fetchTeams()}}},methods:{async fetchStudents(){if(this.team&&this.team.team_id)try{const t=await u.A.get("http://localhost:3000/api/students/students_by_team",{params:{team_id:this.team.team_id}});this.students=t.data}catch(t){console.error("Error fetching students:",t)}},async fetchTeams(){try{const t=await u.A.get("http://localhost:3000/api/teams/starter_teams");this.teams=t.data}catch(t){console.error("Error fetching teams:",t)}},removeStudent(t){confirm("Are you sure you want to delete this student?")&&u.A.delete("http://localhost:3000/api/students/delete_student",{data:{student_id:t}}).then((t=>{this.fetchStudents(),t.data.affectedRows>0&&console.log("Student deleted successfully!")})).catch((t=>{console.error("Error deleting student:",t)}))},openChangeTeamForm(t){this.selectedStudent=t,this.showForm=!0},async submitChange(){if(this.selectedTeamId&&this.selectedStudent)try{console.log("Student id and team id:",this.selectedStudent.student_id,this.selectedTeamId),await u.A.put("http://localhost:3000/api/students/changeTeam",{student_id:this.selectedStudent.student_id,team_id:this.selectedTeamId}),this.fetchStudents(),this.showForm=!1,alert("Student team changed successfully!")}catch(t){console.error("Error changing student team:",t),alert("Error changing student team.")}}}};const St=(0,f.A)(Ct,[["render",kt]]);var Lt=St;const wt={class:"upload-container"},Tt={key:0,class:"file-name"};function Et(t,e,s,o,i,l){return(0,a.uX)(),(0,a.CE)("div",wt,[(0,a.Lk)("div",{class:(0,r.C4)({"drop-zone":!0,"file-selected":i.file}),onDragover:e[0]||(e[0]=(0,n.D$)(((...t)=>l.onDragOver&&l.onDragOver(...t)),["prevent"])),onDrop:e[1]||(e[1]=(0,n.D$)(((...t)=>l.onDrop&&l.onDrop(...t)),["prevent"])),onClick:e[2]||(e[2]=(...t)=>l.fileInputClick&&l.fileInputClick(...t))}," Drag and drop a CSV file here or click to select ",34),(0,a.Lk)("input",{type:"file",ref:"fileInput",onChange:e[3]||(e[3]=(...t)=>l.onFileChange&&l.onFileChange(...t)),style:{display:"none"},accept:".csv"},null,544),i.file?((0,a.uX)(),(0,a.CE)("p",Tt,"Selected file: "+(0,r.v_)(i.file.name),1)):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>l.uploadFile&&l.uploadFile(...t))},"Upload")])}var Ft={data(){return{file:null}},methods:{onDragOver(t){t.preventDefault()},onDrop(t){const e=t.dataTransfer.files;e.length>0&&this.isCsvFile(e[0])?this.file=e[0]:alert("Please drop a CSV file.")},fileInputClick(){this.$refs.fileInput.click()},onFileChange(t){const e=t.target.files;e.length>0&&this.isCsvFile(e[0])?this.file=e[0]:alert("Please select a CSV file.")},isCsvFile(t){return"text/csv"===t.type||t.name.endsWith(".csv")},async uploadFile(){if(!this.file)return void alert("No file selected.");const t=new FormData;t.append("file",this.file);try{await u.A.post("http://localhost:3000/api/csv/upload_csv",t,{headers:{"Content-Type":"multipart/form-data"}}),alert("File uploaded successfully.")}catch(e){console.error("Error uploading file:",e),alert("Error uploading file.")}}}};const Pt=(0,f.A)(Ft,[["render",Et]]);var Xt=Pt,At={name:"TeamDashboard",components:{TeamPoints:O,AdjustPoints:tt,LogsHistory:rt,StudentScoreboard:Lt,CSV:Xt},props:{team:{type:Object,default:null}},data(){return{currentPoints:this.team?this.team.points:0}},methods:{refreshPoints(){this.$refs.teamPoints&&this.$refs.teamPoints.fetchPoints(this.team.team_id)}}};const Ot=(0,f.A)(At,[["render",w]]);var jt=Ot,Dt={name:"App",components:{SliderList:g,TeamDashBoard:jt},data(){return{selectedTeam:null}},methods:{setSelectedTeam(t){this.selectedTeam=t}}};const It=(0,f.A)(Dt,[["render",i]]);var xt=It;(0,n.Ef)(xt).mount("#app")}},e={};function s(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,n,a,o){if(!n){var i=1/0;for(c=0;c<t.length;c++){n=t[c][0],a=t[c][1],o=t[c][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((function(t){return s.O[t](n[l])}))?n.splice(l--,1):(r=!1,o<i&&(i=o));if(r){t.splice(c--,1);var d=a();void 0!==d&&(e=d)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[n,a,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,n){var a,o,i=n[0],r=n[1],l=n[2],d=0;if(i.some((function(e){return 0!==t[e]}))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(l)var c=l(s)}for(e&&e(n);d<i.length;d++)o=i[d],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(c)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(6081)}));n=s.O(n)})();
//# sourceMappingURL=app.1ac283ea.js.map